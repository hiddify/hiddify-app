# üìã –û—Ç—á–µ—Ç –æ–± –∞—É–¥–∏—Ç–µ Android-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Go-bull

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 2025-12-19
**–ü—Ä–æ–µ–∫—Ç:** Hiddify (Go-bull fork)
**–í–µ—Ä—Å–∏—è:** 2.5.7 (20507)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ê–ë–û–¢–û–°–ü–û–°–û–ë–ù–û–ï (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏)

---

## üìä –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ

Android-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ **–≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ**, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π. –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–∞—Ç–∏–≤–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ hiddify-core, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–∫–∞—á–∞—Ç—å –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π.

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** 7/10

---

## üéØ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** Flutter 3.24.0-3.24.3
- **–Ø–∑—ã–∫:** Kotlin + Dart
- **–¢–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** VPN/Proxy –∫–ª–∏–µ–Ω—Ç
- **–ù–∞–∑–≤–∞–Ω–∏–µ:** Go-bull
- **Package ID:** app.hiddify.com
- **–í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** 2.5.7 (build 20507)

### Android SDK
```
minSdkVersion:     21 (Android 5.0 Lollipop)
targetSdkVersion:  34 (Android 14)
compileSdkVersion: 34
NDK Version:       26.1.10909125
Gradle Version:    7.6.1
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- arm64-v8a (64-bit ARM)
- armeabi-v7a (32-bit ARM)
- x86_64 (64-bit Intel)

---

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
- ‚úÖ `android/app/build.gradle` - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ `android/build.gradle` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- ‚úÖ `AndroidManifest.xml` - –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- ‚úÖ Gradle wrapper –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### 2. –ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ **33 Kotlin-—Ñ–∞–π–ª–∞** - –≤—Å–µ –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ `MainActivity.kt` (—Å—Ç—Ä–æ–∫–∏ 1-160) - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Flutter Activity
- ‚úÖ `VPNService.kt` (—Å—Ç—Ä–æ–∫–∏ 1-199) - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å VPN API
- ‚úÖ `BoxService.kt` (—Å—Ç—Ä–æ–∫–∏ 1-363) - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–µ–Ω
- ‚úÖ `ProxyService.kt` - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º –±–µ–∑ VPN
- ‚úÖ –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- ‚úÖ –ù–µ—Ç TODO/FIXME –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞

### 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
‚úÖ Flutter Frontend
‚úÖ Native Android Backend (Kotlin)
‚úÖ VPN Service (android.net.VpnService)
‚úÖ Proxy Service (foreground service)
‚úÖ Quick Settings Tile
‚úÖ Boot Receiver
‚úÖ App Change Receiver
‚úÖ Background Services
‚úÖ Notification System
```

### 4. –†–∞–∑—Ä–µ—à–µ–Ω–∏—è (Permissions)
```xml
‚úÖ INTERNET - –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
‚úÖ FOREGROUND_SERVICE - –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã
‚úÖ FOREGROUND_SERVICE_SPECIAL_USE - –¥–ª—è VPN/Proxy
‚úÖ POST_NOTIFICATIONS - –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Android 13+)
‚úÖ RECEIVE_BOOT_COMPLETED - –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
‚úÖ CHANGE_NETWORK_STATE - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ç—å—é
‚úÖ REQUEST_IGNORE_BATTERY_OPTIMIZATIONS - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞—Ç–∞—Ä–µ–∏
‚úÖ CAMERA - –¥–ª—è QR-—Å–∫–∞–Ω–µ—Ä–∞ –ø–æ–¥–ø–∏—Å–æ–∫
‚úÖ QUERY_ALL_PACKAGES - –¥–ª—è per-app proxy
```

### 5. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Android)
```gradle
‚úÖ androidx.core:core-ktx:1.12.0
‚úÖ androidx.appcompat:appcompat:1.6.1
‚úÖ androidx.lifecycle:lifecycle-livedata-ktx:2.6.2
‚úÖ com.google.code.gson:gson:2.10.1
```

### 6. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Android TV (Leanback Launcher)
- ‚úÖ Per-app proxy —Ä–µ–∂–∏–º (–≤—ã–±–æ—Ä–æ—á–Ω—ã–π VPN –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π)
- ‚úÖ System proxy (Android 10+)
- ‚úÖ Memory limit control
- ‚úÖ Deep Links: `sing-box://`, `clash://`, `hiddify://`
- ‚úÖ Split APK –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞–º

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

### üî¥ –ü—Ä–æ–±–ª–µ–º–∞ #1: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–∞—Ç–∏–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

**–õ–æ–∫–∞—Ü–∏—è:**
- `android/app/libs/` (–ø—É—Å—Ç–æ, —Ç–æ–ª—å–∫–æ .gitkeep)
- `libcore/` (git submodule –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞—Ç–∏–≤–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É `hiddify-core` –≤–µ—Ä—Å–∏–∏ 3.1.8 –¥–ª—è —Ä–∞–±–æ—Ç—ã VPN/Proxy —Ñ—É–Ω–∫—Ü–∏–π. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–∞–ø–∏—Å–∞–Ω–∞ –Ω–∞ Go –∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –≤ `.aar` —Ñ–∞–π–ª –¥–ª—è Android. –ë–µ–∑ –Ω–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —Å–æ–±–µ—Ä–µ—Ç—Å—è.

**–§–∞–π–ª—ã, –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç libbox:**
- `android/app/src/main/kotlin/com/hiddify/hiddify/bg/BoxService.kt:23,26`
- `android/app/src/main/kotlin/com/hiddify/hiddify/bg/VPNService.kt:13`
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç `io.nekohasekai.libbox.*`

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –°–∫–∞—á–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
make android-prepare

# –í–∞—Ä–∏–∞–Ω—Ç 2: –°–æ–±—Ä–∞—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤
git submodule update --init --recursive
make build-android-libs
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —Å–æ–±–µ—Ä–µ—Ç—Å—è –±–µ–∑ —ç—Ç–æ–≥–æ

---

### üü° –ü—Ä–æ–±–ª–µ–º–∞ #2: Flutter –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫–æ–º–∞–Ω–¥—ã `flutter --version` –ø–æ–ª—É—á–µ–Ω–∞ –æ—à–∏–±–∫–∞: `flutter: command not found`

**–¢—Ä–µ–±—É–µ—Ç—Å—è:**
- Flutter –≤–µ—Ä—Å–∏–∏ 3.24.0 - 3.24.3
- Dart SDK (–≤—Ö–æ–¥–∏—Ç –≤ Flutter)

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# Linux
wget https://storage.googleapis.com/flutter_infra_release/releases/stable/linux/flutter_linux_3.24.3-stable.tar.xz
tar xf flutter_linux_3.24.3-stable.tar.xz
export PATH="$PATH:`pwd`/flutter/bin"
flutter doctor

# –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
flutter pub get
flutter pub run build_runner build --delete-conflicting-outputs
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –ë–õ–û–ö–ò–†–£–ï–¢ –°–ë–û–†–ö–£

---

### üü° –ü—Ä–æ–±–ª–µ–º–∞ #3: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç production keystore

**–õ–æ–∫–∞—Ü–∏—è:** `android/key.properties` (–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ release keystore –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ production –≤–µ—Ä—Å–∏–π. –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–∞–π–ª–∞ `key.properties` –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–æ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–º –∫–ª—é—á–æ–º (—Å–º. `android/app/build.gradle:76-93`).

**–¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
```
++
No keystore defined. The app will not be signed.
Create a android/key.properties file with the following properties:
storePassword
keyPassword
keyAlias
storeFile
++
```

**–†–µ—à–µ–Ω–∏–µ:**

1. –°–æ–∑–¥–∞—Ç—å keystore:
```bash
keytool -genkey -v -keystore ~/go-bull-release.jks \
  -keyalg RSA -keysize 2048 -validity 10000 \
  -alias go-bull
```

2. –°–æ–∑–¥–∞—Ç—å `android/key.properties`:
```properties
storePassword=YOUR_STORE_PASSWORD
keyPassword=YOUR_KEY_PASSWORD
keyAlias=go-bull
storeFile=/path/to/go-bull-release.jks
```

3. –î–æ–±–∞–≤–∏—Ç—å –≤ `.gitignore`:
```
android/key.properties
*.jks
*.keystore
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–ê–ñ–ù–û –¥–ª—è production —Ä–µ–ª–∏–∑–æ–≤

---

### üü† –ü—Ä–æ–±–ª–µ–º–∞ #4: Java –≤–µ—Ä—Å–∏—è

**–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è:** OpenJDK 21 (21.0.9)
**–¢—Ä–µ–±—É–µ–º–∞—è –≤–µ—Ä—Å–∏—è:** Java 17 (—Å–æ–≥–ª–∞—Å–Ω–æ `build.gradle:44-45`)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–í `android/app/build.gradle` —É–∫–∞–∑–∞–Ω–æ:
```gradle
compileOptions {
    sourceCompatibility JavaVersion.VERSION_17
    targetCompatibility JavaVersion.VERSION_17
}
```

Java 21 –æ–±—ã—á–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å Java 17, –Ω–æ –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ Gradle –ø–ª–∞–≥–∏–Ω–∞–º–∏.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ Java
update-java-alternatives -l

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Java 17 (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
sudo apt install openjdk-17-jdk

# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ Java 17
sudo update-alternatives --config java
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü† –°–†–ï–î–ù–ò–ô (–º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã)

---

## üìù –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Å–±–æ—Ä–∫–∏

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Flutter 3.24.x
# –°–∫–∞—á–∞—Ç—å —Å https://flutter.dev/docs/get-started/install/linux
wget https://storage.googleapis.com/flutter_infra_release/releases/stable/linux/flutter_linux_3.24.3-stable.tar.xz
tar xf flutter_linux_3.24.3-stable.tar.xz
export PATH="$PATH:`pwd`/flutter/bin"

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É
flutter doctor

# 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Android SDK
flutter doctor --android-licenses

# 4. –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /home/user/hiddify-work
```

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# 1. –°–∫–∞—á–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è Android
make android-prepare

# –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç:
# - flutter pub get
# - dart run build_runner build
# - dart run slang (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤)
# - –°–∫–∞—á–∏–≤–∞–Ω–∏–µ hiddify-core v3.1.8 –¥–ª—è Android

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Å–∫–∞—á–∞–ª–∏—Å—å
ls -la android/app/libs/
# –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è: libcore.aar –∏–ª–∏ —Ñ–∞–π–ª—ã .so

# 3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –°–æ–∑–¥–∞—Ç—å keystore –¥–ª—è production
keytool -genkey -v -keystore ~/go-bull-release.jks \
  -keyalg RSA -keysize 2048 -validity 10000 \
  -alias go-bull

# 4. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –°–æ–∑–¥–∞—Ç—å android/key.properties
```

### –°–±–æ—Ä–∫–∞ APK

```bash
# Debug –≤–µ—Ä—Å–∏—è (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
flutter build apk --debug

# Release –≤–µ—Ä—Å–∏—è (–≤—Å–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –≤ –æ–¥–Ω–æ–º APK)
make android-apk-release

# –ò–õ–ò –≤—Ä—É—á–Ω—É—é:
flutter build apk --release --target-platform android-arm,android-arm64,android-x64

# Split APK (–æ—Ç–¥–µ–ª—å–Ω—ã–π APK –¥–ª—è –∫–∞–∂–¥–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)
flutter build apk --release --split-per-abi

# –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –≤:
# build/app/outputs/flutter-apk/
```

### –°–±–æ—Ä–∫–∞ AAB (–¥–ª—è Google Play)

```bash
make android-aab-release

# –ò–õ–ò –≤—Ä—É—á–Ω—É—é:
flutter build appbundle --release

# –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –≤:
# build/app/outputs/bundle/release/
```

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞

### MainActivity.kt (–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞)

**–§–∞–π–ª:** `android/app/src/main/kotlin/com/hiddify/hiddify/MainActivity.kt:1-160`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ù–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `FlutterFragmentActivity`
- –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç Flutter –ø–ª–∞–≥–∏–Ω—ã (MethodHandler, EventHandler, LogHandler, etc.)
- –£–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏ (VPN, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
- –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Ñ–æ–Ω–æ–≤–æ–º—É —Å–µ—Ä–≤–∏—Å—É —á–µ—Ä–µ–∑ `ServiceConnection`

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã:**
- `startService()` (—Å—Ç—Ä–æ–∫–∞ 60) - –∑–∞–ø—É—Å–∫ VPN/Proxy
- `prepare()` (—Å—Ç—Ä–æ–∫–∞ 83) - –∑–∞–ø—Ä–æ—Å VPN —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- `grantNotificationPermission()` (—Å—Ç—Ä–æ–∫–∞ 126) - –∑–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–û—Ü–µ–Ω–∫–∞:** ‚úÖ –ö–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω, –Ω–µ—Ç –ø—Ä–æ–±–ª–µ–º

---

### VPNService.kt (VPN —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)

**–§–∞–π–ª:** `android/app/src/main/kotlin/com/hiddify/hiddify/bg/VPNService.kt:1-199`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –†–µ–∞–ª–∏–∑—É–µ—Ç `android.net.VpnService`
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç TUN –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç per-app proxy (—Å—Ç—Ä–æ–∫–∏ 147-176)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é (—Å—Ç—Ä–æ–∫–∏ 98-146)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ó–∞—â–∏—Ç–∞ VPN —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: `protect(fd)` (—Å—Ç—Ä–æ–∫–∞ 50)
- System proxy –¥–ª—è Android 10+ (—Å—Ç—Ä–æ–∫–∏ 178-189)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ IPv4 –∏ IPv6

**–û—Ü–µ–Ω–∫–∞:** ‚úÖ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è VPN

---

### BoxService.kt (–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å)

**–§–∞–π–ª:** `android/app/src/main/kotlin/com/hiddify/hiddify/bg/BoxService.kt:1-363`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º sing-box core
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–∞—Ä—Å–∏–Ω–≥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 67-79)
- –ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ VPN (—Å—Ç—Ä–æ–∫–∏ 143-211)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
- Command server –¥–ª—è CLI —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—á–∞—Å—Ç–∫–∏:**
- `initialize()` (—Å—Ç—Ä–æ–∫–∞ 48) - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è libcore
- `startService()` (—Å—Ç—Ä–æ–∫–∞ 143) - –∑–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- `serviceReload()` (—Å—Ç—Ä–æ–∫–∞ 213) - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–û—Ü–µ–Ω–∫–∞:** ‚úÖ –•–æ—Ä–æ—à–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ—Ä—É—Ç–∏–Ω—ã

---

### Application.kt (–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è)

**–§–∞–π–ª:** `android/app/src/main/kotlin/com/hiddify/hiddify/Application.kt:1-43`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Go runtime: `Seq.setContext(this)` (—Å—Ç—Ä–æ–∫–∞ 26)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è broadcast receivers
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**–û—Ü–µ–Ω–∫–∞:** ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

---

## üîí –ê–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –†–∞–∑—Ä–µ—à–µ–Ω–∏—è
‚úÖ –í—Å–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –æ–±–æ—Å–Ω–æ–≤–∞–Ω—ã –¥–ª—è VPN-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚úÖ –ù–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (SMS, –∫–æ–Ω—Ç–∞–∫—Ç—ã, –∏ —Ç.–¥.)
‚ö†Ô∏è `QUERY_ALL_PACKAGES` - —à–∏—Ä–æ–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ, –Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è per-app proxy

### –°–µ—Ç–µ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
‚úÖ VPN —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞—â–∏—â–µ–Ω–æ —á–µ—Ä–µ–∑ `protect()`
‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç foreground service (–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫—Ä—ã—Ç)
‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏
‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç certificate pinning
‚ö†Ô∏è –ù–µ—Ç ProGuard rules (–∫–æ–¥ –Ω–µ –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω)
‚ö†Ô∏è Debug mode –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω –≤ production

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã

### Android Native Code
```
–í—Å–µ–≥–æ Kotlin —Ñ–∞–π–ª–æ–≤:      33
–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:               ~3000+
–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:      8 (Activity, Services, Receivers)
Channel handlers:         6 (–¥–ª—è —Å–≤—è–∑–∏ —Å Flutter)
–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:               5 files
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤
```
com.hiddify.hiddify/
‚îú‚îÄ‚îÄ MainActivity.kt
‚îú‚îÄ‚îÄ Application.kt
‚îú‚îÄ‚îÄ MethodHandler.kt
‚îú‚îÄ‚îÄ EventHandler.kt
‚îú‚îÄ‚îÄ LogHandler.kt
‚îú‚îÄ‚îÄ PlatformSettingsHandler.kt
‚îú‚îÄ‚îÄ Settings.kt
‚îú‚îÄ‚îÄ ShortcutActivity.kt
‚îú‚îÄ‚îÄ *Channel.kt (3 files)
‚îú‚îÄ‚îÄ bg/ (background services)
‚îÇ   ‚îú‚îÄ‚îÄ VPNService.kt
‚îÇ   ‚îú‚îÄ‚îÄ ProxyService.kt
‚îÇ   ‚îú‚îÄ‚îÄ BoxService.kt
‚îÇ   ‚îú‚îÄ‚îÄ TileService.kt
‚îÇ   ‚îú‚îÄ‚îÄ ServiceConnection.kt
‚îÇ   ‚îú‚îÄ‚îÄ ServiceBinder.kt
‚îÇ   ‚îú‚îÄ‚îÄ ServiceNotification.kt
‚îÇ   ‚îú‚îÄ‚îÄ BootReceiver.kt
‚îÇ   ‚îú‚îÄ‚îÄ AppChangeReceiver.kt
‚îÇ   ‚îú‚îÄ‚îÄ DefaultNetworkMonitor.kt
‚îÇ   ‚îú‚îÄ‚îÄ DefaultNetworkListener.kt
‚îÇ   ‚îú‚îÄ‚îÄ LocalResolver.kt
‚îÇ   ‚îî‚îÄ‚îÄ PlatformInterfaceWrapper.kt
‚îú‚îÄ‚îÄ constant/ (5 files)
‚îú‚îÄ‚îÄ ktx/ (Kotlin extensions)
‚îî‚îÄ‚îÄ utils/ (2 files)
```

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–¥–æ –ø–µ—Ä–≤–æ–≥–æ —Ä–µ–ª–∏–∑–∞)
1. ‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç—å `make android-prepare` - —Å–∫–∞—á–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å production keystore
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å ProGuard/R8 –ø—Ä–∞–≤–∏–ª–∞:
```gradle
buildTypes {
    release {
        minifyEnabled true
        shrinkResources true
        proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
    }
}
```

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (1-2 –Ω–µ–¥–µ–ª–∏)
4. –î–æ–±–∞–≤–∏—Ç—å crashlytics/error reporting
5. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏
6. –î–æ–±–∞–≤–∏—Ç—å integration tests
7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å compliance —Å Google Play –ø–æ–ª–∏—Ç–∏–∫–æ–π

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (1-3 –º–µ—Å—è—Ü–∞)
8. –û–±–Ω–æ–≤–∏—Ç—å Gradle –¥–æ 8.x
9. –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ Kotlin DSL –¥–ª—è Gradle
10. –î–æ–±–∞–≤–∏—Ç—å certificate pinning
11. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å split APK optimization
12. –î–æ–±–∞–≤–∏—Ç—å Jetpack Compose –¥–ª—è –Ω–∞—Ç–∏–≤–Ω—ã—Ö UI (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- [ ] VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Proxy —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Per-app proxy —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] Quick Settings Tile —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- [ ] QR-—Å–∫–∞–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Deep links —Ä–∞–±–æ—Ç–∞—é—Ç

**–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã:**
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ Android 5.0 (API 21)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ Android 14 (API 34)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è—Ö (Samsung, Xiaomi, Google)

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
- [ ] arm64-v8a —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] armeabi-v7a —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] x86_64 —Ä–∞–±–æ—Ç–∞–µ—Ç (—ç–º—É–ª—è—Ç–æ—Ä)

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ —Ä–µ—Å—É—Ä—Å—ã

**–ü—Ä–æ–µ–∫—Ç:**
- GitHub: https://github.com/hiddify/hiddify-next
- Core Library: https://github.com/hiddify/hiddify-next-core

**–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**
- Flutter Docs: https://flutter.dev/docs
- Android VpnService API: https://developer.android.com/reference/android/net/VpnService
- Sing-box: https://sing-box.sagernet.org/

---

## üìÑ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Android-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Go-bull (—Ñ–æ—Ä–∫ Hiddify) –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ **—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏** —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π VPN/Proxy —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã:**
1. ‚úÖ –ö–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ
2. ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞
3. ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π
4. ‚ö†Ô∏è –ù—É–∂–µ–Ω production keystore –¥–ª—è —Ä–µ–ª–∏–∑–æ–≤

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –í—ã–ø–æ–ª–Ω–∏—Ç—å `make android-prepare`
2. –°–æ–∑–¥–∞—Ç—å keystore –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
3. –°–æ–±—Ä–∞—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å APK
4. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫ —Ä–µ–ª–∏–∑—É

**–ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞: 7/10** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

---

*–û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ 2025-12-19*
